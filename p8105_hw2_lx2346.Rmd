---
title: "p8105_hw2_lx2346"
author: "linshan"
date: "2024-09-25"
output: github_document
---

# Problem 1
Prepare for the packages that may be used
```{r}
library(tidyverse)
```
## import and clean the NYC Transit data
```{r}
nyc_tran = read_csv("./data of hw2/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",na = "") |>
  janitor::clean_names() |>
  mutate(across(starts_with("route"), as.character)) |>
  pivot_longer(
    route1:route11,
    names_to = NULL, 
    values_to = "routes_served") |>
  filter(routes_served != "") |>
  select(line, station_name, station_latitude,station_longitude, routes_served, entry, vending, entrance_type,ada) |>
  mutate( entry = case_match( entry , "YES"  ~ TRUE, "NO" ~ FALSE)) |>
  mutate( vending = case_match(vending , "YES"  ~ TRUE, "NO" ~ FALSE))
```
## Describe what cleaning work I've done above.
1. Clean the names of the dataset\
2. Combine the routes from route1 to route11 into 1 variable with column name routes_served\
3. Remove blank variable at routes_served\
4. Select the route, station name, station latitude, station longitude, service route, entrance, vending machine, entrance_type, motor variable required by the problem\
5. Convert the entry and vending variable from character (YES vs NO) to a logical variable\

## Describe the NYC Transit Data
**The NYC transit data set has `r nrow(nyc_tran)` rows and `r ncol(nyc_tran)` columns. It is a `r nrow(nyc_tran)`âœ–ï¸`r ncol(nyc_tran)` table.**\
**The variables in the dataset are `r names(nyc_tran)`.**\
To sum up, the dataset lists each of the entry/exit in each subway station. It lists whether or not it is a entry, whether or not it has a vending,  whether or not it has a ADA compliance and the entrance type of each entry/exit. It also lists the information about the station, like which line and route it belongs to and the station's locaton(longitude and latitude).

## Answer the following questions using these data:
**1. How many distinct stations are there? Note that stations are identified both by name and by line (e.g. 125th St 8th Avenue; 125st Broadway; 125st Lenox)**\
\
There are `r nrow(distinct(nyc_tran,station_name))` distinct stations.

**2. How many stations are ADA compliant?**\
```{r}
ada_true = filter(nyc_tran, ada == TRUE)
nrow(distinct(ada_true, station_name))
```
So there are `r nrow(distinct(ada_true, station_name))` distinct stations which are ADA compliant.\

**3. What proportion of station entrances / exits without vending allow entrance?**\
\
`r nrow(filter(nyc_tran, vending == FALSE))/nrow(nyc_tran)`

### Reformat data making route number and route name distinct variables
```{r}
nyc_tran_2 = read_csv("./data of hw2/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",na = "") |>
  janitor::clean_names() |>
  mutate(across(starts_with("route"), as.character)) |>
  pivot_longer(
    route1:route11,
    names_to = "route_number", 
    values_to = "route_name",
    names_prefix = "route") |>
  filter(route_name != "")
#find the distinct station serves A route & ada. 
serve_a = filter(nyc_tran_2, route_name == "A")
serve_a_ada = filter(serve_a, ada == TRUE)
```

So there are `r nrow(distinct(serve_a, station_name))` diatinct stations serves A. And among those stations serves A, there are `r nrow(distinct(serve_a_ada, station_name))` stations are ADA compliant.

# Problem 2
## import and clean mr_trash data
```{r}
library(readxl)
mr_trash = read_excel("./data of hw2/202309 Trash Wheel Collection Data.xlsx", range = "A2:N586") |>
  janitor::clean_names() |>
  mutate(sports_balls = round(sports_balls)) |>
  mutate(sports_balls = as.integer(sports_balls)) |>
  pivot_longer(
    plastic_bottles: sports_balls,
    names_to = "type_of _trash",
    values_to = "numbers"
  ) |>
  mutate(type = "Mr.")
```

## use the same way import Professor Trash Wheel and Gwynnda data
```{r}
# import professor trash wheel
prof_trash = read_excel("./data of hw2/202309 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel", range = "A2:M108") |>
  janitor::clean_names() |>
  pivot_longer(
    plastic_bottles: wrappers,
    names_to = "type_of _trash",
    values_to = "numbers"
  ) |>
  mutate(type = "Professor") |>
  mutate(year = as.character(year))
# import Gwynnda Trash Wheel
gwy_trash = read_excel("./data of hw2/202309 Trash Wheel Collection Data.xlsx", sheet = "Gwynnda Trash Wheel", range = "A2:L157") |>
  janitor::clean_names() |>
  pivot_longer(
    plastic_bottles: wrappers,
    names_to = "type_of _trash",
    values_to = "numbers"
  ) |>
  mutate(type = "Gwynnda") |>
  mutate(year = as.character(year))
```

## combine the 3 dataset
```{r}
trash = bind_rows( prof_trash, gwy_trash, mr_trash)
```


